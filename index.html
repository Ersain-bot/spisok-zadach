<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="manifest" href="manifest.json">
    <style>
        .task-done {
            text-decoration: line-through;
        }
    
        .btn:active {
            transform: translateY(2px);
        }
    
        .btn-primary:active {
            background-color: #0069d9;
            border-color: #0069d9;
        }
    
        .btn-success:active {
            background-color: #34c759;
            border-color: #34c759;
        }
    
        .btn-danger:active {
            background-color: #dc3545;
            border-color: #dc3545;
        }
    
        .scale-up {
            animation: scaleUp 0.2s;
        }
    
        @keyframes scaleUp {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }
    
        .scale-down {
            animation: scaleDown 0.2s;
        }
    
        @keyframes scaleDown {
            0% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    
        #timer-text {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 24px;
            font-weight: bold;
            z-index: 999;
            background-color: white;
            padding: 6px 10px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
    
        .btn {
            border-radius: 10px;
        }
    
        .btn-flat {
            border-radius: 0;
        }
    
        .btn-right {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
    
        .btn-success {
            border-radius: 20px;
        }
    
        .btn-3-right {
            border-top-right-radius: 20px !important;
            border-bottom-right-radius: 20px !important;
        }
    
        .mr-20 {
            margin-right: 20px;
        }
    
        /* üëá –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã */
        @media (max-width: 576px) {
            .btn-group {
                display: flex;
                flex-direction: column;
                width: 100%;
            }
    
            .btn-group .btn {
                width: 100%;
                margin-bottom: 10px;
            }
    
            .modal-content {
                padding: 10px;
            }
    
            .modal-body input {
                font-size: 16px;
            }
    
            table th, table td {
                font-size: 14px;
                padding: 8px;
            }
    
            #timer-text {
                font-size: 16px;
                bottom: 5px;
                right: 5px;
            }
    
            h1, h4.card-title {
                font-size: 24px;
                text-align: center;
            }
    
            .btn {
                font-size: 14px;
            }
    
            .table-responsive {
                overflow-x: auto;
            }
    
            .container {
                padding-left: 10px;
                padding-right: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1>–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á</h1>
        <ul id="task-list" class="list-group mt-3">
            <!-- –ó–∞–¥–∞—á–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </ul>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á -->
    <div class="modal fade" id="addTaskModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="new-task" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" id="add-task-btn">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–¥–∞—á -->
    <div class="modal fade" id="editTaskModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="edit-task" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞—á—É">
                    <input type="hidden" id="task-index" value="">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" id="edit-task-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞–π–º–µ—Ä–∞ -->
    <div class="modal fade" id="timerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="number" id="timer-value" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" class="btn btn-primary" id="start-timer-btn">–ù–∞—á–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <div class="row">
            <div class="col-12 grid-margin">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">–ó–∞–¥–∞—á–∏</h4>
                        <div class="d-flex justify-content-between">
                            <div>
                                <button type="button" class="btn btn-primary me-2 rounded" data-bs-toggle="modal" data-bs-target="#addTaskModal">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                                <button type="button" class="btn btn-primary me-2 rounded" data-bs-toggle="modal" data-bs-target="#editTaskModal" id="edit-task-button">–ò–∑–º–µ–Ω–∏—Ç—å</button>
                                <button type="button" class="btn btn-danger rounded" id="delete-task-button">–£–¥–∞–ª–∏—Ç—å</button>
                            </div>
                            <div>
                                <button type="button" class="btn btn-info me-2 rounded" data-bs-toggle="modal" data-bs-target="#timerModal" id="timer-button">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä</button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>–ó–∞–¥–∞—á–∞</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                    </tr>
                                </thead>
                                <tbody id="task-grid">
                                    <!-- –ó–∞–¥–∞—á–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <p id="timer-text"></p>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        let tasks = [];
        let currentTaskIndex = null;
        let timer = null;
        let timerValue = 0;

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Å–ø–∏—Å–æ–∫
        function addTask(task) {
            tasks.push({ text: task, done: false, priority1: false, priority2: false, priority3: false });
            renderTaskGrid();
            renderTaskList();
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
        function renderTaskList() {
            const taskList = $('#task-list');
            taskList.empty();

            tasks.forEach((task, index) => {
                const taskItem = $('<li class="list-group-item">');
                const taskText = $('<span>').text(task.text);
                const buttonGroup = $('<div class="btn-group float-end">');

                if (task.done) {
                    taskText.addClass('task-done');
                }

                const priority1Button = $('<button class="btn btn-success">1</button>');
                const priority2Button = $('<button class="btn btn-success">2</button>');
                const priority3Button = $('<button class="btn btn-success btn-3-right">3</button>');

                priority1Button.click(() => {
                    task.priority1 = !task.priority1;
                    if (task.priority1 && task.priority2 && task.priority3) {
                        task.done = true;
                    } else {
                        task.done = false;
                    }
                    renderTaskList();
                    renderTaskGrid();
                });

                priority2Button.click(() => {
                    task.priority2 = !task.priority2;
                    if (task.priority1 && task.priority2 && task.priority3) {
                        task.done = true;
                    } else {
                        task.done = false;
                    }
                    renderTaskList();
                    renderTaskGrid();
                });

                priority3Button.click(() => {
                    task.priority3 = !task.priority3;
                    if (task.priority1 && task.priority2 && task.priority3) {
                        task.done = true;
                    } else {
                        task.done = false;
                    }
                    renderTaskList();
                    renderTaskGrid();
                });

                const editButton = $('<button class="btn btn-primary me-2 rounded">–ò–∑–º–µ–Ω–∏—Ç—å</button>');
                editButton.click(() => {
                    currentTaskIndex = index;
                    $('#edit-task').val(task.text);
                    $('#task-index').val(index);
                    $('#editTaskModal').modal('show');
                });

                const deleteButton = $('<button class="btn btn-danger rounded">–£–¥–∞–ª–∏—Ç—å</button>');
                deleteButton.click(() => {
                    tasks.splice(index, 1);
                    renderTaskGrid();
                    renderTaskList();
                });

                if (task.priority1) {
                    priority1Button.removeClass('btn-success').addClass('btn-danger');
                }
                if (task.priority2) {
                    priority2Button.removeClass('btn-success').addClass('btn-danger');
                }
                if (task.priority3) {
                    priority3Button.removeClass('btn-success').addClass('btn-danger');
                }

                buttonGroup.append(priority1Button).append(priority2Button).append(priority3Button).append($(`<span class="mr-20"></span>`)).append(editButton).append(deleteButton);
                taskItem.append(taskText).append(buttonGroup);
                taskList.append(taskItem);
            });

            if (tasks.length === 0) {
                $('#edit-task-button').prop('disabled', true);
                $('#delete-task-button').prop('disabled', true);
            } else {
                $('#edit-task-button').prop('disabled', false);
                $('#delete-task-button').prop('disabled', false);
            }
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä–∏–∑–∞ –∑–∞–¥–∞—á
        function renderTaskGrid() {
            const taskGrid = $('#task-grid');
            taskGrid.empty();

            tasks.forEach((task, index) => {
                const taskRow = $('<tr>');
                const taskCell = $('<td>').text(task.text);
                const statusCell = $('<td>');

                if (task.done) {
                    statusCell.text('–í—ã–ø–æ–ª–Ω–µ–Ω–æ');
                } else {
                    statusCell.text('–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ');
                }

                taskRow.append(taskCell).append(statusCell);
                taskGrid.append(taskRow);
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
        $('#add-task-btn').click(() => {
            const newTask = $('#new-task').val();
            addTask(newTask);
            $('#new-task').val('');
            $('#addTaskModal').modal('hide');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∑–∞–¥–∞—á–∏
        $('#edit-task-btn').click(() => {
            const taskIndex = $('#task-index').val();
            tasks[taskIndex].text = $('#edit-task').val();
            renderTaskGrid();
            renderTaskList();
            $('#editTaskModal').modal('hide');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–∞–π–º–µ—Ä–∞
        $('#start-timer-btn').click(() => {
            timerValue = parseInt($('#timer-value').val()) * 60; // –£–º–Ω–æ–∂–∞–µ–º –º–∏–Ω—É—Ç—ã –Ω–∞ 60
            if (!isNaN(timerValue) && timerValue > 0) {
                timer = setInterval(() => {
                    timerValue--;
                    const minutes = Math.floor(timerValue / 60);
                    const seconds = timerValue % 60;
                    $('#timer-text').text(`–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: ${minutes} –º–∏–Ω—É—Ç ${seconds} —Å–µ–∫—É–Ω–¥`);
                    if (timerValue === 0) {
                        clearInterval(timer);
                        timer = null;
                        $('#timer-text').text('');
                    }
                }, 1000);
            }
            $('#timerModal').modal('hide');
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
        addTask('–ó–∞–¥–∞—á–∞ 1');
        addTask('–ó–∞–¥–∞—á–∞ 2');

        $('#edit-task-button').click(() => {
            if (tasks.length > 0) {
                $('#edit-task').val(tasks[0].text);
                $('#task-index').val(0);
                $('#editTaskModal').modal('show');
            }
        });

        $('#delete-task-button').click(() => {
            if (tasks.length > 0) {
                tasks.shift();
                renderTaskGrid();
                renderTaskList();
            }
        });

        $(document).ready(function () {
            $('.btn').on('mousedown', function () {
                $(this).addClass('scale-down');
            });

            $('.btn').on('mouseup', function () {
                $(this).removeClass('scale-down').addClass('scale-up');
            });

            $('.btn').on('mouseout', function () {
                $(this).removeClass('scale-up');
            });
        });
    </script>
</body>
</html>